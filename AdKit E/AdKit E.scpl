Comment "AdKit E - embedded ads in Shortcuts\n\nMade by @FifiTheBulldog, based on AdKit by @eaic\n\nAccepts a dictionary as input (please note that this is not quite identical to the dictionary for AdKit):\n\n\"Function\": \"AdKit\"\n\"ID\": ad ID\n\"Menu\": vCard menu to append ads\n\"Prompt\": menu prompt"
GetDictionaryValue key="Function"
If input="Equals" "AdKit"
  GetCurrentIPAddress
  Count "Items"
  If input="Is Greater Than" number=0
    GetVariable s:ShortcutInput
    GetDictionaryValue key="ID" -> mv:adID
    URL "https://acceptable.a-ads.com/\(mv:adID)"
    MakeHTMLFromRichText false
    MatchText pattern="<a href=\"(https:\\/\\/click\\.a-ads.com\\/[^\"]+)\"[^>]+>([\\s\\S\\n]+?)<\\/a>" -> mv:HTMLMatches
    GetGroupFromMatchedText get="Group At Index" groupIndex = 1 -> mv:AdURL
    Text "\n" -> mv:newLine
    GetVariable mv:HTMLMatches
    GetGROUpfrommatchedtext get="Group At Index" groupIndex = 2
    MakeRichTextFromHTML
    ReplaceText findtext="\\n+" replacewith="\(mv:newLine)" regularexpression=true
    ReplaceText findtext="\\n$" replacewith="" regularexpression=true
    SplitText separator="new lines" -> mv:splitAd
    GetItemFromList get="items in range" getItemsFromIndex=2
    CombineText separator="custom" custom=" | " -> mv:Description
    GetVariable mv:splitAd
    GetItemFromList get="first item" -> mv:AdTitle
    Comment "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"
    Text "Paste base64 encoded icon here" -> mv:Icon
    Text "BEGIN:VCARD\nVERSION:3.0\nN;CHARSET=utf-8:\(mv:AdTitle);;;;\nORG;CHARSET=utf-8:\(mv:Description);\nPHOTO;ENCODING=b:\(mv:Icon)\nEND:VCARD"
  Otherwise
    Nothing
  End If -> mv:Ad
  GetVariable s:ShortcutInput
  GetDictionaryValue key="Menu" -> mv:Menu
  GetVariable s:ShortcutInput
  GetDictionaryValue key="Prompt" -> mv:Prompt
  Text "\(mv:Menu)\n\(mv:Ad)"
  SetName name="menu.vcf"
  GetContactsFromInput
  ChooseFromList prompt="\(mv:Prompt)" selectMultiple=false
  GetTextFromInput
  If input="Equals" "\(mv:AdTitle)"
    GetVariable mv:AdURL
    OpenURLs
    Nothing
    ShowNotification title="⏸ Shortcut Paused" body="Return to Shortcuts to continue." playSound=false
    WaitToReturn
    GetVariable s:ShortcutInput
    Comment "\"Run Shortcut\" should call the \"self\" shortcut to rerun the pseudo-function."
    RunShortcut showWhileRunning=false
  Otherwise
  End If
  ExitShortcut
Otherwise
End If
